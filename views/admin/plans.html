<!-- File: views/admin/plans.html -->
{{ define "content" }}
<div class="mb-3">
    <button type="button" class="btn btn-primary" data-toggle="modal" data-target="#createPlanModal">
        <span data-feather="plus"></span> Create New Plan
    </button>
</div>

<div class="card mb-4">
    <div class="card-header">
        <span>Investment Plans</span>
    </div>
    <div class="card-body">
        <div class="table-responsive">
            <table class="table table-striped">
                <thead>
                    <tr>
                        <th>ID</th>
                        <th>Name</th>
                        <th>Price</th>
                        <th>Daily Deposit Limit</th>
                        <th>Daily Withdrawal Limit</th>
                        <th>Daily Profit Limit</th>
                        <th>Default</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody>
                    {{ range .plans }}
                    <tr>
                        <td>{{ .ID }}</td>
                        <td>{{ .Name }}</td>
                        <td>{{ .Price }} BDT</td>
                        <td>{{ .DailyDepositLimit }} BDT</td>
                        <td>{{ .DailyWithdrawalLimit }} BDT</td>
                        <td>{{ .DailyProfitLimit }} BDT</td>
                        <td>
                            {{ if .IsDefault }}
                            <span class="badge badge-success">Default</span>
                            {{ else }}
                            <span class="badge badge-secondary">No</span>
                            {{ end }}
                        </td>
                        <td>
                            <div class="btn-group btn-group-sm">
                                <button type="button" class="btn btn-info" data-toggle="modal" data-target="#editPlanModal{{ .ID }}">
                                    Edit
                                </button>
                                {{ if not .IsDefault }}
                                <form action="/admin/plans/{{ .ID }}/default" method="post" class="d-inline">
                                    <button type="submit" class="btn btn-success">Set Default</button>
                                </form>
                                <form action="/admin/plans/{{ .ID }}/delete" method="post" class="d-inline">
                                    <button type="submit" class="btn btn-danger" onclick="return confirm('Are you sure you want to delete this plan?');">Delete</button>
                                </form>
                                {{ end }}
                            </div>
                        </td>
                    </tr>
                    {{ end }}
                </tbody>
            </table>
        </div>
    </div>
</div>

<!-- Create Plan Modal -->
<div class="modal fade" id="createPlanModal" tabindex="-1" aria-labelledby="createPlanModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <form action="/admin/plans" method="post">
                <div class="modal-header">
                    <h5 class="modal-title" id="createPlanModalLabel">Create New Plan</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <div class="form-group">
                        <label for="name">Plan Name:</label>
                        <input type="text" class="form-control" id="name" name="name" required>
                    </div>
                    <div class="form-group">
                        <label for="price">Price (BDT):</label>
                        <input type="number" class="form-control" id="price" name="price" min="0" step="0.01" required>
                    </div>
                    <div class="form-group">
                        <label for="daily_deposit_limit">Daily Deposit Limit (BDT):</label>
                        <input type="number" class="form-control" id="daily_deposit_limit" name="daily_deposit_limit" min="0" step="0.01" required>
                    </div>
                    <div class="form-group">
                        <label for="daily_withdrawal_limit">Daily Withdrawal Limit (BDT):</label>
                        <input type="number" class="form-control" id="daily_withdrawal_limit" name="daily_withdrawal_limit" min="0" step="0.01" required>
                    </div>
                    <div class="form-group">
                        <label for="daily_profit_limit">Daily Profit Limit (BDT):</label>
                        <input type="number" class="form-control" id="daily_profit_limit" name="daily_profit_limit" min="0" step="0.01" required>
                    </div>
                    <div class="form-check">
                        <input type="checkbox" class="form-check-input" id="is_default" name="is_default">
                        <label class="form-check-label" for="is_default">Set as Default Plan</label>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>
                    <button type="submit" class="btn btn-primary">Create Plan</button>
                </div>
            </form>
        </div>
    </div>
</div>

<!-- Edit Plan Modals -->
{{ range .plans }}
<div class="modal fade" id="editPlanModal{{ .ID }}" tabindex="-1" aria-labelledby="editPlanModalLabel{{ .ID }}" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <form action="/admin/plans/{{ .ID }}" method="post">
                <div class="modal-header">
                    <h5 class="modal-title" id="editPlanModalLabel{{ .ID }}">Edit Plan: {{ .Name }}</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <div class="form-group">
                        <label for="name{{ .ID }}">Plan Name:</label>
                        <input type="text" class="form-control" id="name{{ .ID }}" name="name" value="{{ .Name }}" required>
                    </div>
                    <div class="form-group">
                        <label for="price{{ .ID }}">Price (BDT):</label>
                        <input type="number" class="form-control" id="price{{ .ID }}" name="price" value="{{ .Price }}" min="0" step="0.01" required>
                    </div>
                    <div class="form-group">
                        <label for="daily_deposit_limit{{ .ID }}">Daily Deposit Limit (BDT):</label>
                        <input type="number" class="form-control" id="daily_deposit_limit{{ .ID }}" name="daily_deposit_limit" value="{{ .DailyDepositLimit }}" min="0" step="0.01" required>
                    </div>
                    <div class="form-group">
                        <label for="daily_withdrawal_limit{{ .ID }}">Daily Withdrawal Limit (BDT):</label>
                        <input type="number" class="form-control" id="daily_withdrawal_limit{{ .ID }}" name="daily_withdrawal_limit" value="{{ .DailyWithdrawalLimit }}" min="0" step="0.01" required>
                    </div>
                    <div class="form-group">
                        <label for="daily_profit_limit{{ .ID }}">Daily Profit Limit (BDT):</label>
                        <input type="number" class="form-control" id="daily_profit_limit{{ .ID }}" name="daily_profit_limit" value="{{ .DailyProfitLimit }}" min="0" step="0.01" required>
                    </div>
                    <div class="form-check">
                        <input type="checkbox" class="form-check-input" id="is_default{{ .ID }}" name="is_default" {{ if .IsDefault }}checked{{ end }}>
                        <label class="form-check-label" for="is_default{{ .ID }}">Set as Default Plan</label>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>
                    <button type="submit" class="btn btn-primary">Update Plan</button>
                </div>
            </form>
        </div>
    </div>
</div>
{{ end }}
{{ end }}